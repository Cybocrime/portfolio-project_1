"use strict";(self.webpackChunknew_material_ui_tut=self.webpackChunknew_material_ui_tut||[]).push([[507],{5507:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var a=r(1014),n=r(8801),s=r(9533),o=r(7733),l=r(9133),i=r(1546),c=r(4063),m=r(1793),d=r(8769),u=r(7653),p=r(2362),w=r(7395),h=r(9165),f=r(5183),E=r(5824),g=r(4843),y=r(4508),A=r(2870),k=r(412),x=r(9779),v=r(9795),b=r(7843),C=r(958),S=r(3212),P=r(6603),I=r(4098),U=r(6526);const R=()=>{const[e,t]=(0,a.useState)(!1),[r,R]=(0,a.useState)(0),[W,z]=(0,a.useState)(!1),[D,L]=(0,a.useState)({email:"",password:"",confirmPassword:""}),[F,M]=(0,a.useState)(""),[B,_]=(0,a.useState)(!1),[G,j]=(0,a.useState)(null),[J,H]=(0,a.useState)(!1),[T,$]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)(!1),[Q,N]=(0,a.useState)([]),[O,q]=(0,a.useState)(""),[K,V]=(0,a.useState)(null),[X,ee]=(0,a.useState)({comments:!1,addComment:!1,addReply:!1,auth:!1}),[te,re]=(0,a.useState)(""),[ae,ne]=(0,a.useState)("success"),[se,oe]=(0,a.useState)(!1),le=e=>{const{name:t,value:r}=e.target;L((e=>({...e,[t]:i.A.sanitize(r.trim())})))},ie=(e,t)=>{re(e),ne(t),oe(!0)},ce=(0,a.useRef)(null);(0,a.useEffect)((()=>{const e=()=>{ce.current&&clearTimeout(ce.current),ce.current=setTimeout(me,9e5)};return window.addEventListener("mousemove",e),window.addEventListener("keydown",e),window.addEventListener("click",e),e(),()=>{clearTimeout(ce.current),window.removeEventListener("mousemove",e),window.removeEventListener("keydown",e),window.removeEventListener("click",e)}}),[]),(0,a.useEffect)((()=>{if(1===r){ee((e=>({...e,comments:!0})));const e=async()=>{try{const{comments:e}=await(0,s.p4)();N(e)}catch(e){console.error("Error fetching comments:",e)}finally{ee((e=>({...e,comments:!1})))}};e()}}),[r]);const me=async()=>{await(0,c.CI)(s.j2),V(null)};(0,a.useEffect)((()=>{const e=(0,c.hg)(s.j2,(e=>{V(e?{userId:e.uid,email:e.email}:null)}));return()=>e()}),[]);const de=()=>{$((e=>!e))},ue=(0,a.useRef)(0),pe=()=>{const e=Date.now();return e-ue.current<5e3?(ie("Slow down! Please wait before taking another action."),!1):(ue.current=e,!0)},we=()=>{oe(!1)},he=(0,a.useRef)(0),fe=(0,l.debounce)((async(e,t,r,a,n,s,o)=>{const l=Date.now();if(l-he.current<3e3)return void s("Please wait before liking/disliking again.","error");if(he.current=l,!r)return void s("Please log in to like or dislike comments.","error");const i=r.userId;if(!a.find((t=>t.id===e)))return void console.error(`Comment with ID ${e} not found.`);const c=[...a],m=a.map((r=>{if(r.id!==e)return r;let a=r.likes||0,n=r.dislikes||0,s=[...r.likesUser],o=[...r.dislikesUser];return"like"===t?s.includes(i)?(a=Math.max(a-1,0),s=s.filter((e=>e!==i))):(o.includes(i)&&(n=Math.max(n-1,0),o=o.filter((e=>e!==i))),a+=1,s.push(i)):"dislike"===t&&(o.includes(i)?(n=Math.max(n-1,0),o=o.filter((e=>e!==i))):(s.includes(i)&&(a=Math.max(a-1,0),s=s.filter((e=>e!==i))),n+=1,o.push(i))),{...r,likes:a,dislikes:n,likesUser:s,dislikesUser:o}}));n(m);try{const t=m.find((t=>t.id===e));if(!t)throw new Error("Updated comment not found.");await o(e,t)}catch(d){console.error("Error updating like/dislike:",d),n(c),s("Unable to update like/dislike. Please try again.","error")}}),1e3),Ee=(e,t)=>{fe(e,t,K,Q,N,ie,s.Pc)};return a.createElement(a.Fragment,null,a.createElement(d.A,{variant:"contained",onClick:()=>t(!0),sx:{backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"},boxShadow:3,borderRadius:"50%",width:"50px",height:"50px",display:"flex",justifyContent:"center",alignItems:"center",padding:0}},a.createElement(C.A,{sx:{color:"white",fontSize:"20px"}})," "),a.createElement(u.A,{open:e,onClose:()=>{t(!1),L({email:"",password:"",confirmPassword:""}),M("")},sx:{zIndex:10}},a.createElement(p.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"87%",sm:610},bgcolor:"background.paper",boxShadow:24,borderRadius:2,p:3}},K&&a.createElement(p.A,{sx:{display:"flex",justifyContent:"center",mb:1}},a.createElement(w.A,{onClick:me,color:"error"},a.createElement(m.A,null))),a.createElement(h.A,{value:r,onChange:(e,t)=>{R(t)},centered:!0},a.createElement(f.A,{label:"Add Comment"}),a.createElement(f.A,{label:"Comments"})),a.createElement(p.A,{mt:2},0===r&&a.createElement(a.Fragment,null,K?a.createElement(a.Fragment,null,K&&a.createElement(p.A,{mt:3},a.createElement(g.A,{fullWidth:!0,label:"Add a Comment",variant:"outlined",margin:"normal",multiline:!0,value:F,onChange:e=>M(e.target.value)}),a.createElement(d.A,{fullWidth:!0,variant:"contained",color:"primary",sx:{mt:2},onClick:async()=>{if(!pe())return;if(!F.trim())return ie("Please enter a valid comment.","error");ee((e=>({...e,addComment:!0})));const e=i.A.sanitize(F);try{const t=await(0,s.BC)(e,K);N((e=>[t,...e])),M(""),ie("Comment added successfully.","success")}catch(t){console.error("Error adding comment: ",t),ie("Error adding comment. Please try again.","error")}finally{ee((e=>({...e,addComment:!1})))}}},X.addComment?a.createElement(U.A,{size:24,sx:{color:"white"}}):"Add Comment"))):a.createElement(a.Fragment,null,!B&&!W&&!J&&a.createElement(p.A,{sx:{p:2,border:"1px solid #ccc",borderRadius:"8px",backgroundColor:"#f9f9f9"}},a.createElement(E.A,{variant:"body2",color:"textSecondary"},"Your feedback is important to us! We value transparency and ensure your comments are securely stored and reviewed to improve our aluminum and glazing services. Please sign up or log in to share your thoughts with us, knowing your information is kept safe."),a.createElement(d.A,{fullWidth:!0,variant:"contained",color:"primary",sx:{mt:2},onClick:()=>_(!0)},"Sign Up to Share Feedback"),a.createElement(d.A,{fullWidth:!0,variant:"text",color:"secondary",sx:{mt:1},onClick:()=>z(!0)},"Already have an account? Sign In")),J&&a.createElement(a.Fragment,null,a.createElement(E.A,{variant:"h6",color:"textPrimary",sx:{mb:2}},"Reset Your Password"),a.createElement(E.A,{variant:"body2",color:"textSecondary",sx:{mb:3}},"Enter your email address below, and we'll send you a link to reset your password."),a.createElement(g.A,{fullWidth:!0,name:"email",label:"Email",variant:"outlined",margin:"normal",value:D.email,onChange:le,sx:{mb:2}}),a.createElement(d.A,{fullWidth:!0,variant:"contained",color:"primary",sx:{mt:2},onClick:async()=>{ee((e=>({...e,auth:!0})));try{const e=(0,n.P)((0,n.rJ)(s.db,"users"),(0,n._M)("email","==",D.email));if((await(0,n.GG)(e)).empty)return void ie("No account found with this email.","error");const t=await(0,s.xw)(D.email);ie(t.message,"success")}catch(e){ie(e.message||"An unexpected error occurred.","error")}finally{ee((e=>({...e,auth:!1})))}},disabled:!D.email||X.auth},X.auth?a.createElement(U.A,{size:24,sx:{color:"white"}}):"Send Reset Link"),a.createElement(d.A,{fullWidth:!0,variant:"text",color:"secondary",sx:{mt:1},onClick:()=>{H(!1),z(!0)}},"Back to Login")),B&&a.createElement(a.Fragment,null,a.createElement(g.A,{fullWidth:!0,label:"Email",name:"email",variant:"outlined",margin:"normal",value:D.email,onChange:le}),a.createElement(g.A,{fullWidth:!0,label:"Password",name:"password",type:T?"text":"password",variant:"outlined",margin:"normal",autoComplete:"new-password",value:D.password,onChange:le,slotProps:{input:{endAdornment:a.createElement(y.A,{position:"end"},a.createElement(w.A,{onClick:de},T?a.createElement(I.A,null):a.createElement(P.A,null)))}}}),a.createElement(g.A,{fullWidth:!0,label:"Confirm Password",name:"confirmPassword",type:Y?"text":"password",variant:"outlined",margin:"normal",autoComplete:"new-password",value:D.confirmPassword,onChange:le,slotProps:{input:{endAdornment:a.createElement(y.A,{position:"end"},a.createElement(w.A,{onClick:()=>{Z((e=>!e))}},Y?a.createElement(I.A,null):a.createElement(P.A,null)))}}}),a.createElement(d.A,{fullWidth:!0,variant:"contained",color:"primary",sx:{mt:2},onClick:async()=>{ee((e=>({...e,auth:!0})));try{if(!(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(D.email))return void ie("Invalid email format.","error");if(D.password!==D.confirmPassword)return void ie("Passwords do not match.","error");await(0,s.hA)(D.email,D.password),L({email:"",password:"",confirmPassword:""}),ie("Signup successful. Please verify your email.","success"),_(!1),z(!0)}catch(e){console.error("Signup Error:",e),ie(`Signup failed: ${e.code||"Unknown error"}`,"error")}finally{ee((e=>({...e,auth:!1})))}},disabled:!D.email||!D.password||!D.confirmPassword||X.auth},X.auth?a.createElement(U.A,{size:24,sx:{color:"white"}}):"Sign Up"),a.createElement(d.A,{fullWidth:!0,variant:"text",color:"secondary",sx:{mt:1},onClick:()=>{_(!1),z(!1)}},"Cancel")),W?a.createElement(a.Fragment,null,a.createElement(g.A,{fullWidth:!0,label:"Email",name:"email",variant:"outlined",margin:"normal",value:D.email,onChange:le}),a.createElement(g.A,{fullWidth:!0,label:"Password",name:"password",type:T?"text":"password",variant:"outlined",margin:"normal",autoComplete:"new-password",value:D.password,onChange:le,slotProps:{input:{endAdornment:a.createElement(y.A,{position:"end"},a.createElement(w.A,{onClick:de},T?a.createElement(I.A,null):a.createElement(P.A,null)))}}}),a.createElement(E.A,{variant:"body2",color:"primary",sx:{mt:1,cursor:"pointer",textAlign:"center"},onClick:()=>{z(!1),H(!0)}},"Forgot Password? Reset it here."),a.createElement(d.A,{fullWidth:!0,variant:"contained",color:"primary",sx:{mt:2},onClick:async()=>{ee((e=>({...e,auth:!0})));try{if(!(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(D.email))return void ie("Invalid email format.","error");const e=await(0,s.Qv)(D.email,D.password);L({email:"",password:"",confirmPassword:""}),V({userId:e.uid,email:e.email,isAuthenticated:!0}),z(!1),ie("Login successful.","success")}catch(e){ie(e.message||"An unexpected error occurred.","error")}finally{ee((e=>({...e,auth:!1})))}},disabled:!D.email||!D.password||X.auth},X.auth?a.createElement(U.A,{size:24,sx:{color:"white"}}):"Sign In"),a.createElement(d.A,{fullWidth:!0,variant:"text",color:"secondary",sx:{mt:1},onClick:()=>{z(!1),_(!1)}},"Cancel")):null)),1===r&&a.createElement(p.A,{sx:{maxHeight:"400px",overflowY:"auto",padding:0,borderRadius:"8px",width:"100%"}},0===Q.length?a.createElement(E.A,{variant:"body1"},"No comments yet."):X.comments?a.createElement(p.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px"}},a.createElement(U.A,null)):Q.map((e=>a.createElement(p.A,{key:e.id,sx:{marginBottom:2,padding:0,borderRadius:"8px",backgroundColor:"white"}},a.createElement(p.A,{mt:1,sx:{borderBottom:"1px solid #ccc",pb:2}},a.createElement(p.A,{display:"flex",alignItems:"center"},a.createElement(S.A,null)," ",a.createElement(p.A,{ml:2},a.createElement(E.A,{variant:"body2"},e.content))),a.createElement(p.A,{display:"flex",alignItems:"center"},a.createElement(w.A,{onClick:()=>Ee(e.id,"like"),sx:{fontSize:"1rem",mr:1,gap:"0.3rem",color:e.likesUser.includes(K?.userId)?"blue":"gray"}},a.createElement(A.A,null),e.likes),a.createElement(w.A,{onClick:()=>Ee(e.id,"dislike"),sx:{fontSize:"1rem",mr:1,gap:"0.3rem",color:e.dislikesUser.includes(K?.userId)?"red":"gray"}},a.createElement(v.A,null),e.dislikes),a.createElement(p.A,{ml:2},a.createElement(E.A,{variant:"body2",color:"textSecondary",sx:{fontSize:"0.75rem"}},(0,o.m)(e.timestamp)+" ago")),a.createElement(w.A,{onClick:()=>{return t=e.id,void j((e=>e===t?null:t));var t},sx:{fontSize:"1rem",color:G===e.id?"green":"gray"}},a.createElement(b.A,null),e.replies.length)),G===e.id&&a.createElement(p.A,{mt:2},a.createElement(g.A,{fullWidth:!0,label:"Reply to this comment",variant:"outlined",margin:"normal",multiline:!0,value:O,onChange:e=>q(e.target.value)}),a.createElement(d.A,{fullWidth:!0,variant:"contained",color:"primary",sx:{mt:2},onClick:()=>(async e=>{if(!pe())return;if(!O.trim())return void ie("Please enter a valid reply.","error");ee((e=>({...e,addReply:!0})));const t=i.A.sanitize(O),r={userId:K.userId,userEmail:K.email,content:t,timestamp:new Date};try{await(0,s.Ic)(e,r),q(""),console.log("Reply added successfully:",r),ie("Reply added successfully.","success")}catch(a){console.error("Error adding reply: ",a),ie("Error adding reply. Please try again.","error")}finally{ee((e=>({...e,addReply:!1})))}})(e.id)},X.addReply?a.createElement(U.A,{size:24,sx:{color:"white"}}):"Add Reply"),e.replies.length>0&&a.createElement(p.A,{mt:2},e.replies.map((e=>a.createElement(p.A,{key:e.id,sx:{ml:7,mb:1,p:1,border:"1px solid #C0C0C0",borderRadius:2,backgroundColor:"#E8E9E8",display:"flex",alignItems:"center"}},a.createElement(S.A,null)," ",a.createElement(p.A,{ml:2},a.createElement(E.A,{variant:"body2"},e.content))))))))))))))),a.createElement(k.A,{open:se,autoHideDuration:6e3,onClose:we,anchorOrigin:{vertical:"bottom",horizontal:"center"},sx:{zIndex:20}},a.createElement(x.A,{onClose:we,severity:ae,sx:{width:"100%"}},te)))}},9533:(e,t,r)=>{r.d(t,{BC:()=>w,IG:()=>m,Ic:()=>E,Pc:()=>h,Qv:()=>u,db:()=>c,hA:()=>d,j2:()=>i,p4:()=>p,xw:()=>f});var a=r(6255),n=r(4063),s=r(8801),o=r(7330);const l=(0,a.Wp)({apiKey:"AIzaSyBw4R0Ymop0zd8ii4hZlxO4b8R6Nkt4w5Y",authDomain:"sliders-fafac.firebaseapp.com",databaseURL:"https://sliders-fafac-default-rtdb.firebaseio.com",projectId:"sliders-fafac",storageBucket:"sliders-fafac.appspot.com",messagingSenderId:"191649720492",appId:"1:191649720492:web:5156bb1192b9d2393f5709",measurementId:"G-CKXQLWJ2QW"}),i=(0,n.xI)(l),c=(0,s.aU)(l),m=(0,o.c7)(l),d=async(e,t)=>{try{if(t.length<8)throw new Error("Password must be at least 8 characters long.");if(!/[A-Z]/.test(t)||!/[0-9]/.test(t)||!/[!@#$%^&*(),.?":{}|<>]/.test(t))throw new Error("Password must include at least one uppercase letter, one number, and one special character.");if((await(0,n.Wm)(i,e)).length>0)throw new Error("Email already in use.");const r=(await(0,n.eJ)(i,e,t)).user;return await(0,n.gA)(r),r}catch(r){throw console.error("Error during signup:",r.message),r}},u=async(e,t)=>{try{const r=(await(0,n.x9)(i,e,t)).user;if(!r.emailVerified)throw new Error("Please verify your email before logging in.");const a=(0,s.rJ)(c,"sessions"),o=(0,s.P)(a,(0,s._M)("userId","==",r.uid),(0,s._M)("isActive","==",!0)),l=await(0,s.GG)(o);l.empty||l.forEach((async e=>{await(0,s.mZ)((0,s.H9)(c,"sessions",e.id),{isActive:!1})}));return{user:r,sessionId:(await(0,s.gS)(a,{userId:r.uid,email:r.email,loginTime:new Date,isActive:!0})).id}}catch(r){throw console.error("Error during sign-in:",r.message),r}},p=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=(0,s.rJ)(c,"comments");let r=(0,s.P)(t,(0,s.My)("timestamp","desc"),(0,s.AB)(10));e&&(r=(0,s.P)(t,(0,s.My)("timestamp","desc"),(0,s.HM)(e),(0,s.AB)(10)));const a=await(0,s.GG)(r);return{comments:a.docs.map((e=>{const t=e.data();return{id:e.id,content:t.content,userEmail:t.userEmail,timestamp:t.timestamp?.toDate()||new Date,likes:t.likesUser?.length||0,dislikes:t.dislikesUser?.length||0,replies:t.replies||[],likesUser:t.likesUser||[],dislikesUser:t.dislikesUser||[]}})),lastVisible:a.docs[a.docs.length-1]}}catch(t){throw console.error("Error fetching comments:",t.message),t}},w=async(e,t)=>{try{if(!t||!t.email||!t.userId)throw new Error("User not authenticated.");const r=(0,s.rJ)(c,"comments"),a={userEmail:t.email,userId:t.userId,content:e,timestamp:(0,s.O5)(),likes:0,dislikes:0,adminEmail:"",replies:[],likesUser:[],dislikesUser:[],isEdited:!1,lastEditedTimestamp:null},n=await(0,s.gS)(r,a);return a.id=n.id,a}catch(r){throw console.error("Error adding comment:",r.message),r}},h=async(e,t)=>{try{const r=(0,s.H9)(c,"comments",e),a=await(0,s.x7)(r);if(!a.exists())throw console.error("Document not found for docId:",e),new Error(`Comment with ID ${e} not found.`);console.log("Document fetched successfully:",a.data());const n={likes:t.likes??0,dislikes:t.dislikes??0,likesUser:Array.isArray(t.likesUser)?t.likesUser:[],dislikesUser:Array.isArray(t.dislikesUser)?t.dislikesUser:[]};await(0,s.mZ)(r,n),console.log("Comment updated successfully.")}catch(r){throw console.error("Error updating Firestore document:",r.message),r}},f=async e=>{try{if(!e)throw new Error("Email address is required.");return await(0,n.J1)(i,e),console.log("Password reset email sent successfully to:",e),{success:!0,message:"Password reset email sent."}}catch(t){throw console.error("Error sending password reset email:",t.message),t}},E=async(e,t)=>{try{console.log("Debug: commentDocId passed to addReplyToComment:",e);const r=(0,s.H9)(c,"comments",e);await(0,s.mZ)(r,{replies:(0,s.hq)(t)}),console.log("Reply added successfully to comment:",e)}catch(r){throw console.error("Error adding reply to comment:",r.message),r}}}}]);
//# sourceMappingURL=507.0b5b9574.chunk.js.map